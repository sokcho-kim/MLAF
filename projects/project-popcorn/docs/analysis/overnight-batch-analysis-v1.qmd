---
title: "Cross-Domain Radar ì•¼ê°„ ë°°ì¹˜ ë¶„ì„ ë¦¬í¬íŠ¸"
subtitle: "ë¶€ì²˜ë³„ ê°ì§€ íŠ¹ì„± ë° ì„ê³„ê°’ ìµœì í™”"
author: "Project Popcorn"
date: "2026-01-19"
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    theme: cosmo
    fig-width: 10
    fig-height: 6
execute:
  echo: true
  warning: false
---

## ê°œìš”

### ë¶„ì„ ëª©ì 

- **ë¶€ì²˜ë³„ Cross-Domain ê°ì§€ íŠ¹ì„± íŒŒì•…**: ì–´ë–¤ ë¶€ì²˜ê°€ íƒ€ ì†Œê´€ ë²•ì•ˆì— ë§ì´ ì˜í–¥ë°›ëŠ”ì§€
- **ì„ê³„ê°’ ìµœì í™”**: ì‚°ì—…í†µìƒë¶€ ê¸°ì¤€ ìµœì  ì„ê³„ê°’ ë„ì¶œ
- **ìš´ì˜ ì „ëµ ìˆ˜ë¦½**: ë¶€ì²˜ë³„ ë§ì¶¤ ì„ê³„ê°’ ë° ì•Œë¦¼ ì „ëµ ì œì‹œ

### ë°ì´í„°ì…‹

| í•­ëª© | ê°’ |
|------|-----|
| ì „ì²´ ë²•ì•ˆ ìˆ˜ | 1,021ê±´ |
| ë¶„ì„ ë¶€ì²˜ ìˆ˜ | 14ê°œ |
| í…ŒìŠ¤íŠ¸ ì„ê³„ê°’ | 6ê°œ (0.40~0.50) |
| ì„ë² ë”© ëª¨ë¸ | OpenAI text-embedding-3-small |

```{python}
#| label: setup
#| code-summary: "ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ë°ì´í„° ë¡œë“œ"

import json
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib as mpl
from pathlib import Path

# í•œê¸€ í°íŠ¸ ì„¤ì •
plt.rcParams['font.family'] = 'AppleGothic'
plt.rcParams['axes.unicode_minus'] = False

# ë°ì´í„° ë¡œë“œ
data_dir = Path("../output/overnight_batch")

with open(data_dir / "ministry_scan_summary.json", "r", encoding="utf-8") as f:
    ministry_data = json.load(f)

with open(data_dir / "threshold_comparison.json", "r", encoding="utf-8") as f:
    threshold_data = json.load(f)

# DataFrame ë³€í™˜
ministry_df = pd.DataFrame(ministry_data["results"])
ministry_df["detection_rate_pct"] = ministry_df["detection_rate"] * 100

threshold_df = pd.DataFrame(threshold_data["results"])
threshold_df["detection_rate_pct"] = threshold_df["detection_rate"] * 100

# ì‚°ì—…í†µìƒë¶€ ì¶”ê°€
motie = {
    "ministry": "ì‚°ì—…í†µìƒë¶€",
    "total_bills": 1021,
    "total_alerts": 614,
    "detection_rate": 0.601,
    "detection_rate_pct": 60.1,
    "alerts_by_level": {"LOW": 530, "MEDIUM": 82, "HIGH": 2, "CRITICAL": 0}
}
ministry_df = pd.concat([ministry_df, pd.DataFrame([motie])], ignore_index=True)
ministry_df = ministry_df.sort_values("detection_rate", ascending=False).reset_index(drop=True)
```

---

## ë¶€ì²˜ë³„ ìŠ¤ìº” ê²°ê³¼

### ê°ì§€ìœ¨ ìˆœìœ„

```{python}
#| label: fig-ministry-detection
#| fig-cap: "ë¶€ì²˜ë³„ Cross-Domain ë²•ì•ˆ ê°ì§€ìœ¨"
#| code-summary: "ë¶€ì²˜ë³„ ê°ì§€ìœ¨ ì‹œê°í™”"

fig, ax = plt.subplots(figsize=(12, 8))

colors = []
for rate in ministry_df["detection_rate_pct"]:
    if rate >= 50:
        colors.append("#e74c3c")  # ë¹¨ê°• (ë²”ìš©í˜•)
    elif rate >= 20:
        colors.append("#f39c12")  # ì£¼í™© (ì¤‘ê°„í˜•)
    else:
        colors.append("#27ae60")  # ì´ˆë¡ (íŠ¹í™”í˜•)

bars = ax.barh(ministry_df["ministry"], ministry_df["detection_rate_pct"], color=colors)
ax.set_xlabel("ê°ì§€ìœ¨ (%)", fontsize=12)
ax.set_title("ë¶€ì²˜ë³„ Cross-Domain ë²•ì•ˆ ê°ì§€ìœ¨", fontsize=14, fontweight="bold")
ax.axvline(x=50, color="red", linestyle="--", alpha=0.5, label="ë²”ìš©í˜• ê¸°ì¤€ (50%)")
ax.axvline(x=20, color="orange", linestyle="--", alpha=0.5, label="íŠ¹í™”í˜• ê¸°ì¤€ (20%)")

# ê°’ í‘œì‹œ
for bar, rate in zip(bars, ministry_df["detection_rate_pct"]):
    ax.text(bar.get_width() + 1, bar.get_y() + bar.get_height()/2,
            f'{rate:.1f}%', va='center', fontsize=10)

ax.legend(loc="lower right")
ax.invert_yaxis()
plt.tight_layout()
plt.show()
```

### ë¶€ì²˜ ìœ í˜• ë¶„ë¥˜

```{python}
#| label: tbl-ministry-types
#| tbl-cap: "ë¶€ì²˜ ìœ í˜•ë³„ ë¶„ë¥˜"
#| code-summary: "ë¶€ì²˜ ìœ í˜• ë¶„ë¥˜ í…Œì´ë¸”"

def categorize(rate):
    if rate >= 50:
        return "ğŸ”´ ë²”ìš©í˜•"
    elif rate >= 20:
        return "ğŸŸ¡ ì¤‘ê°„í˜•"
    else:
        return "ğŸŸ¢ íŠ¹í™”í˜•"

ministry_df["ìœ í˜•"] = ministry_df["detection_rate_pct"].apply(categorize)
ministry_df["ê°ì§€ìœ¨"] = ministry_df["detection_rate_pct"].apply(lambda x: f"{x:.1f}%")

display_df = ministry_df[["ministry", "total_alerts", "ê°ì§€ìœ¨", "ìœ í˜•"]].copy()
display_df.columns = ["ë¶€ì²˜", "ê°ì§€ ë²•ì•ˆ", "ê°ì§€ìœ¨", "ìœ í˜•"]
display_df
```

### Alert Level ë¶„í¬

```{python}
#| label: fig-alert-levels
#| fig-cap: "ë¶€ì²˜ë³„ Alert Level ë¶„í¬"
#| code-summary: "Alert Level ìŠ¤íƒ ë°” ì°¨íŠ¸"

# Alert Level ì¶”ì¶œ
alert_data = []
for _, row in ministry_df.iterrows():
    levels = row["alerts_by_level"]
    alert_data.append({
        "ministry": row["ministry"],
        "HIGH": levels.get("HIGH", 0),
        "MEDIUM": levels.get("MEDIUM", 0),
        "LOW": levels.get("LOW", 0),
    })

alert_df = pd.DataFrame(alert_data)

fig, ax = plt.subplots(figsize=(12, 8))

x = range(len(alert_df))
width = 0.6

low = ax.barh(alert_df["ministry"], alert_df["LOW"], label="LOW", color="#3498db")
medium = ax.barh(alert_df["ministry"], alert_df["MEDIUM"], left=alert_df["LOW"],
                  label="MEDIUM", color="#f39c12")
high = ax.barh(alert_df["ministry"], alert_df["HIGH"],
                left=alert_df["LOW"] + alert_df["MEDIUM"], label="HIGH", color="#e74c3c")

ax.set_xlabel("ê°ì§€ ë²•ì•ˆ ìˆ˜", fontsize=12)
ax.set_title("ë¶€ì²˜ë³„ Alert Level ë¶„í¬", fontsize=14, fontweight="bold")
ax.legend(loc="lower right")
ax.invert_yaxis()
plt.tight_layout()
plt.show()
```

---

## ì„ê³„ê°’ ë¹„êµ ë¶„ì„

### ì„ê³„ê°’ë³„ ê°ì§€ìœ¨ ë³€í™”

```{python}
#| label: fig-threshold
#| fig-cap: "ì„ê³„ê°’ì— ë”°ë¥¸ ê°ì§€ìœ¨ ë³€í™” (ì‚°ì—…í†µìƒë¶€)"
#| code-summary: "ì„ê³„ê°’ ê°ì§€ìœ¨ ë¼ì¸ ì°¨íŠ¸"

fig, ax = plt.subplots(figsize=(10, 6))

ax.plot(threshold_df["threshold"], threshold_df["detection_rate_pct"],
        marker="o", linewidth=2, markersize=10, color="#3498db")

# í˜„ì¬ ì„ê³„ê°’ í‘œì‹œ
ax.axvline(x=0.45, color="red", linestyle="--", alpha=0.7, label="í˜„ì¬ ì„ê³„ê°’ (0.45)")
ax.axhline(y=60.1, color="red", linestyle=":", alpha=0.5)

# ê°’ í‘œì‹œ
for x, y in zip(threshold_df["threshold"], threshold_df["detection_rate_pct"]):
    ax.annotate(f'{y:.1f}%', (x, y), textcoords="offset points",
                xytext=(0, 10), ha='center', fontsize=11)

ax.set_xlabel("ì„ê³„ê°’", fontsize=12)
ax.set_ylabel("ê°ì§€ìœ¨ (%)", fontsize=12)
ax.set_title("ì„ê³„ê°’ì— ë”°ë¥¸ ê°ì§€ìœ¨ ë³€í™” (ì‚°ì—…í†µìƒë¶€)", fontsize=14, fontweight="bold")
ax.legend()
ax.grid(True, alpha=0.3)
ax.set_ylim(20, 95)
plt.tight_layout()
plt.show()
```

### ì„ê³„ê°’ êµ¬ê°„ë³„ ê°ì†ŒëŸ‰

```{python}
#| label: fig-threshold-diff
#| fig-cap: "ì„ê³„ê°’ êµ¬ê°„ë³„ ê°ì§€ ë²•ì•ˆ ê°ì†ŒëŸ‰"
#| code-summary: "ì„ê³„ê°’ êµ¬ê°„ë³„ ì°¨ì´ ë°” ì°¨íŠ¸"

threshold_df["diff"] = threshold_df["total_alerts"].diff().fillna(0).astype(int)

fig, ax = plt.subplots(figsize=(10, 5))

labels = [f"{threshold_df.iloc[i]['threshold']:.2f}â†’{threshold_df.iloc[i+1]['threshold']:.2f}"
          for i in range(len(threshold_df)-1)]
diffs = threshold_df["diff"].iloc[1:].values

colors = ["#e74c3c" if d < -100 else "#f39c12" for d in diffs]
bars = ax.bar(labels, diffs, color=colors)

ax.axhline(y=0, color="black", linewidth=0.5)
ax.set_xlabel("ì„ê³„ê°’ êµ¬ê°„", fontsize=12)
ax.set_ylabel("ê°ì§€ ë²•ì•ˆ ë³€í™”", fontsize=12)
ax.set_title("ì„ê³„ê°’ êµ¬ê°„ë³„ ê°ì§€ ë²•ì•ˆ ê°ì†ŒëŸ‰", fontsize=14, fontweight="bold")

for bar, d in zip(bars, diffs):
    ax.text(bar.get_x() + bar.get_width()/2, bar.get_height() - 10,
            str(d), ha='center', va='top', fontsize=11, fontweight="bold", color="white")

plt.tight_layout()
plt.show()
```

### ì„ê³„ê°’ë³„ ìƒì„¸ ë¹„êµ

```{python}
#| label: tbl-threshold
#| tbl-cap: "ì„ê³„ê°’ë³„ ìƒì„¸ ê²°ê³¼"
#| code-summary: "ì„ê³„ê°’ ë¹„êµ í…Œì´ë¸”"

threshold_display = threshold_df[["threshold", "total_alerts", "detection_rate_pct"]].copy()
threshold_display.columns = ["ì„ê³„ê°’", "ê°ì§€ ë²•ì•ˆ", "ê°ì§€ìœ¨ (%)"]
threshold_display["ê°ì§€ìœ¨ (%)"] = threshold_display["ê°ì§€ìœ¨ (%)"].apply(lambda x: f"{x:.1f}%")
threshold_display["ê¶Œì¥"] = ["", "", "", "âœ… ê¶Œì¥", "", ""]
threshold_display
```

---

## í•µì‹¬ ì¸ì‚¬ì´íŠ¸

### 1. ë¶€ì²˜ íŠ¹ì„±ì— ë”°ë¥¸ ì „ëµ

::: {.callout-important}
## ì¸ì‚¬ì´íŠ¸ 1: ë²”ìš©í˜• ë¶€ì²˜ëŠ” ì„ê³„ê°’ ìƒí–¥ í•„ìš”
**í–‰ì •ì•ˆì „ë¶€**ëŠ” 75%ê°€ ê°ì§€ë˜ì–´ ë…¸ì´ì¦ˆê°€ ë§ìŒ
â†’ ì„ê³„ê°’ 0.50 ì´ìƒ ë˜ëŠ” HIGH/MEDIUMë§Œ ì•Œë¦¼ ê¶Œì¥
:::

::: {.callout-tip}
## ì¸ì‚¬ì´íŠ¸ 2: íŠ¹í™”í˜• ë¶€ì²˜ëŠ” Cross-Domain ê°ì§€ì— ìµœì 
**êµ­í† êµí†µë¶€**(12.2%), **ë¬¸í™”ì²´ê´€ë¶€**(14.4%)ëŠ” ë„ë©”ì¸ íŠ¹í™”ë„ê°€ ë†’ìŒ
â†’ ê°ì§€ëœ ë²•ì•ˆì€ ì‹¤ì œ Cross-Domainì¼ ê°€ëŠ¥ì„± ë†’ìŒ
:::

::: {.callout-note}
## ì¸ì‚¬ì´íŠ¸ 3: ì‚°ì—…í†µìƒë¶€ëŠ” ì¤‘ê°„ ìœ„ì¹˜
60.1% ê°ì§€ìœ¨ë¡œ ë²”ìš©/íŠ¹í™” ì¤‘ê°„
â†’ í˜„ì¬ ì„ê³„ê°’ 0.45 ì ì •, í•„ìš”ì‹œ 0.44ë¡œ í•˜í–¥ ê°€ëŠ¥
:::

### 2. ì„ê³„ê°’ ì „ëµ ë§¤íŠ¸ë¦­ìŠ¤

```{python}
#| label: fig-strategy-matrix
#| fig-cap: "ë¶€ì²˜ ìœ í˜• Ã— ì„ê³„ê°’ ì „ëµ ë§¤íŠ¸ë¦­ìŠ¤"
#| code-summary: "ì „ëµ ë§¤íŠ¸ë¦­ìŠ¤ íˆíŠ¸ë§µ"

import numpy as np

fig, ax = plt.subplots(figsize=(10, 6))

# ë§¤íŠ¸ë¦­ìŠ¤ ë°ì´í„°
ministries_types = ["ë²”ìš©í˜•\n(í–‰ì •ì•ˆì „ë¶€ ë“±)", "ì¤‘ê°„í˜•\n(ì‚°ì—…í†µìƒë¶€ ë“±)", "íŠ¹í™”í˜•\n(êµ­í† êµí†µë¶€ ë“±)"]
thresholds = ["0.42\n(ê³ ê°ë„)", "0.45\n(ê· í˜•)", "0.50\n(ì •ë°€)"]

# ì í•©ë„ ì ìˆ˜ (1: ë¶€ì í•©, 2: ë³´í†µ, 3: ì í•©)
matrix = np.array([
    [1, 2, 3],  # ë²”ìš©í˜•
    [2, 3, 2],  # ì¤‘ê°„í˜•
    [3, 2, 1],  # íŠ¹í™”í˜•
])

im = ax.imshow(matrix, cmap="RdYlGn", aspect="auto", vmin=1, vmax=3)

ax.set_xticks(range(len(thresholds)))
ax.set_yticks(range(len(ministries_types)))
ax.set_xticklabels(thresholds, fontsize=11)
ax.set_yticklabels(ministries_types, fontsize=11)

# ê°’ í‘œì‹œ
labels = [["âš ï¸ ê³¼ë‹¤", "ë³´í†µ", "âœ… ê¶Œì¥"],
          ["ë³´í†µ", "âœ… ê¶Œì¥", "ë³´í†µ"],
          ["âœ… ê¶Œì¥", "ë³´í†µ", "âš ï¸ ëˆ„ë½"]]

for i in range(len(ministries_types)):
    for j in range(len(thresholds)):
        ax.text(j, i, labels[i][j], ha="center", va="center", fontsize=12)

ax.set_xlabel("ì„ê³„ê°’", fontsize=12)
ax.set_ylabel("ë¶€ì²˜ ìœ í˜•", fontsize=12)
ax.set_title("ë¶€ì²˜ ìœ í˜• Ã— ì„ê³„ê°’ ì „ëµ ë§¤íŠ¸ë¦­ìŠ¤", fontsize=14, fontweight="bold")
plt.tight_layout()
plt.show()
```

---

## ê¶Œì¥ì‚¬í•­

### ë‹¨ê¸° (ì¦‰ì‹œ ì ìš©)

| í•­ëª© | ê¶Œì¥ |
|------|------|
| ì‚°ì—…í†µìƒë¶€ ì„ê³„ê°’ | 0.45 ìœ ì§€ |
| ì•Œë¦¼ í•„í„° | HIGH/MEDIUMë§Œ ì¼ì¼ ì•Œë¦¼, LOWëŠ” ì£¼ê°„ ì§‘ê³„ |

### ì¤‘ê¸° (1ê°œì›” ë‚´)

1. **ë¶€ì²˜ë³„ ë§ì¶¤ ì„ê³„ê°’ ë„ì…**
   - ë²”ìš©í˜• ë¶€ì²˜: 0.50+
   - ì¤‘ê°„í˜• ë¶€ì²˜: 0.45
   - íŠ¹í™”í˜• ë¶€ì²˜: 0.42~0.44

2. **ë‹¤ì¤‘ ë¶€ì²˜ ë™ì‹œ ëª¨ë‹ˆí„°ë§**
   - íŠ¹í™”í˜• ë¶€ì²˜ 3ê°œ (êµ­í† ë¶€, ë¬¸í™”ë¶€, ì™¸êµë¶€) ìš°ì„  ì ìš©

### ì¥ê¸° (3ê°œì›” ë‚´)

1. **í”¼ë“œë°± ë£¨í”„ êµ¬ì¶•**: ì‹¤ì œ Cross-Domain ì—¬ë¶€ ë¼ë²¨ë§ â†’ ì„ê³„ê°’ ìë™ ì¡°ì •
2. **ë¶€ì²˜ ê°„ êµì°¨ ë¶„ì„**: Aë¶€ì²˜ ì†Œê´€ ë²•ì•ˆì´ Bë¶€ì²˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë§¤íŠ¸ë¦­ìŠ¤

---

## ë¶€ë¡

### ì‹¤í–‰ í™˜ê²½

- Python 3.12.12
- OpenAI API (text-embedding-3-small)
- ì‹¤í–‰ ì‹œê°„: ì•½ 10ë¶„ (ìºì‹œ í™œìš©)

### ì‚°ì¶œë¬¼ ìœ„ì¹˜

```
output/overnight_batch/
â”œâ”€â”€ ministries/                    # ë¶€ì²˜ë³„ ìƒì„¸ ë¦¬í¬íŠ¸
â”œâ”€â”€ thresholds/                    # ì„ê³„ê°’ë³„ ê²°ê³¼
â”œâ”€â”€ ministry_scan_summary.json     # ë¶€ì²˜ë³„ ìš”ì•½
â”œâ”€â”€ threshold_comparison.json      # ì„ê³„ê°’ ë¹„êµ
â””â”€â”€ overnight_summary.md           # ì „ì²´ ìš”ì•½
```
