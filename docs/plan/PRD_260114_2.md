클로드에게 프로젝트의 **배경, 기술적 의사결정, 데이터 전략, 그리고 구체적인 실행 계획**을 명확하게 전달하기 위한 **Project Context 문서(Markdown)**입니다.

이 내용을 그대로 복사해서 클로드에게 주면, 지금까지 우리가 논의한 모든 맥락을 완벽하게 이해하고 코딩을 시작할 수 있습니다.

---

# Project Popcorn: 입법 리스크 레이더 (Legislative Risk Radar)

## 1. 프로젝트 개요

* **목표:** 특정 부처(예: 산업부)와 연관된 타 상임위 법안의 **'보이지 않는 규제(Hidden Impact)'**를 선제적으로 감지하고, 대응 논리를 포함한 보고서를 자동 생성하는 MVP 구축.
* **핵심 가치:**
* **Zero-Click:** 사용자의 입력 없이 실시간으로 신규 법안을 감지.
* **Hidden Risk:** 단순 키워드 매칭이 아닌 **의미론적(Semantic) 분석**으로 타 부처 소관 법안 내의 위협 탐지.
* **Actionable:** 즉시 결재 가능한 HWP 보고서 초안 생성.



## 2. 배경 및 문제 정의 (Why?)

* **약사법 딜레마:** "약사법" 개정안에 "공장 설비 규제" 조항이 포함될 경우, 소관위가 보건복지위라 산업부가 이를 놓치는 사례 발생.
* **기존 아폴로(Apollo)와의 차별점:**
* 아폴로: 법안 통과 예측(Prediction) 및 요약.
* **팝콘(Popcorn):** 리스크 감지(Detection) 및 대응 논리 수립(Defense).


* **협업 전략:** 아폴로의 정제된 데이터(의안정보, 상태값)를 활용하되, 독자적인 **비정형 텍스트 분석(검토보고서, 제안이유)**에 집중.

## 3. 기술 스택 및 인프라 (Architecture)

**제약 사항:** 월 $110 (약 15만 원) 예산, 1인 개발, 인프라 운영 리소스 최소화.

| 구분 | 선택 기술 | 선정 근거 |
| --- | --- | --- |
| **Server** | **AWS Lightsail** | 4GB RAM, 2 vCPU ($20/월). 안정적인 24h 가동 환경. |
| **Vector DB** | **Qdrant** | **Rust 기반 고성능.** Docker로 구축. Hybrid Search(키워드+의미) 및 정밀 필터링 지원. |
| **LLM** | **Upstage Solar Pro** | 한국어/법률 특화 모델. GPT-4o 대비 가성비 및 기술 내재화 명분. |
| **Embedding** | **Solar Embedding** | 법률 용어의 뉘앙스 파악 및 국회법 데이터 정밀 벡터화. |
| **App** | **Streamlit** | 빠른 MVP 시연 및 UI 구축. |
| **Orchestration** | **LangGraph** | 리스크 분석 → 선례 검색 → 보고서 작성을 병렬(Parallel) 처리. |

## 4. 데이터 수집 전략 (Dual-Track)

*아폴로 팀의 시행착오(통합 API 오류)를 바탕으로 최적화된 전략 수립.*

* **Track 1 (Base): 공공데이터포털 (국회의안목록정보)**
* **역할:** 학습용 DB 구축 (과거 데이터).
* **이유:** 데이터 정제 상태가 검증됨. Qdrant에 미리 적재하여 선례 분석용 지식 베이스로 활용.


* **Track 2 (Radar): 열린국회정보 API (`TVBPMBILL11`)**
* **역할:** 실시간 신규 법안 감지 & 텍스트 보강.
* **이유:** `제안이유` 등 개요 텍스트가 포함되어 있어, 파일 다운로드 전 1차 리스크 감지 가능.
* **Fallback:** API 불안정 시 국회 의안정보시스템 웹 크롤링으로 전환.



## 5. 핵심 기능 로직

### A. Cross-Domain Radar (리스크 감지)

* **Vector Similarity:** 법안 텍스트 벡터 vs 부처 R&R(업무분장) 벡터 간 **Dot Product** 계산.
* **Trigger:** `소관위 불일치` AND `유사도 > 0.82` 시 경고 발령.

### B. 스마트 유사 사례 검색 (Qdrant)

* **기존 방식의 한계:** 단순 의안명 매칭(BM25)은 "약사법"과 "의약품법"을 연결하지 못함.
* **Popcorn 방식:** **Vector Search**를 통해 의안명+제안이유의 **의미적 유사성**을 판단하여 진짜 유사 사례(Precedents)를 추출.

### C. HWP 보고서 생성

* **병렬 처리:** LangGraph를 활용하여 요약, 리스크 분석, 선례 검색을 동시에 수행.
* **Slot-Filling:** 분석된 데이터를 미리 정의된 HWP 템플릿의 누름틀(Field)에 주입.

## 6. 연구 과제 (Engineering Depth)

*단순 구현을 넘어 기술적 깊이를 확보하기 위한 실험 병행.*

1. **Tokenizer 비교:** OpenAI `tiktoken` vs Solar `tokenizer`의 한국어 법률 용어 처리 효율 비교.
2. **Embedding 시각화:** t-SNE를 활용하여 법률 용어(예: 의사봉-방망이)의 벡터 공간 내 군집화 시각화.

## 7. 프로젝트 구조 (Directory)

```text
project-popcorn/
├── docker-compose.yml      # Qdrant 실행 설정
├── data/                   # 공공데이터포털/국회 데이터 (JSON)
├── src/
│   ├── ingest.py           # 데이터 수집 및 Qdrant 적재 (Dual-Track)
│   ├── radar.py            # 리스크 감지 로직
│   ├── agent.py            # LangGraph 워크플로우
│   └── report.py           # HWP 생성 모듈
└── research/               # 토크나이저/임베딩 실험 코드

```